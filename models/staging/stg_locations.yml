models:
  - name: stgLocations
    description: List of open locations with basic cleaning and transformation applied, one row per location.
    columns:
      - name: locationId
        description: The unique key for each location.
        data_tests:
          - not_null
          - unique

unit_tests:
  - name: testDoesLocationOpenedAtTruncToDate
    description: "Check that openedAt timestamp is properly truncated to a date."
    model: stgLocations
    given:
      - input: source('ecom', 'rawStores')
        rows:
          - {
              id: 1,
              name: "Vice City",
              taxRate: 0.2,
              openedAt: "2016-09-01T00:00:00",
            }
          - {
              id: 2,
              name: "San Andreas",
              taxRate: 0.1,
              openedAt: "2079-10-27T23:59:59.9999",
            }
    expect:
      rows:
        - {
            locationId: 1,
            locationName: "Vice City",
            taxRate: 0.2,
            openedDate: "2016-09-01",
          }
        - {
            locationId: 2,
            locationName: "San Andreas",
            taxRate: 0.1,
            openedDate: "2079-10-27",
          }